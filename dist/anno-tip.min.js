var AnnoTip=function(t,e){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;function n(t){if(t.startContainer==t.endContainer&&t.startOffset>t.endOffset){var e=t.startOffset;t.setStartOffset(t.endOffset),t.setEndOffset(e)}return t}function o(e,n){var i=this;if(this.element=e,this.settings=t.extend(!0,{},o.defaults,n),!this.element.ownerDocument)throw new Error("Non-attached element used for text selection: ".concat(e));this.document=this.element.ownerDocument,t(this.document.body).on("mouseup.".concat("annotip-text"),(function(t){i._handleSelection(t)}))}function i(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}function s(n){this.settings=t.extend(!0,{},s.defaults,n),"string"==typeof this.settings.textSelection&&(this.settings.textSelection=this.settings.textSelection.toLowerCase()),e.setDefaultProps(this.settings.tippySettings),this.selections=[]}return o.prototype.detach=function(){this.document&&t(this.document.body).off(".".concat("annotip-text"))},o.prototype._handleSelection=function(e){var o=this.document.getSelection();if(!o.isCollapsed){for(var i,s,r=[],a=0;a<o.rangeCount;++a){var l=o.getRangeAt(a);t.contains(this.element,l.commonAncestorContainer)&&(!this.multipleNodes&&0!=r.length&&(i=r[0],s=l,t.unique([i.startContainer,i.endContainer,s.startContainer,s.endContainer]).length>0)||r.push(n(l)))}r.length>0&&this.settings.onSelection(o.toString(),e,function(t){if(0==t.length)return null;if(1==t.length)return t[0];var e=t[t.length-1],n=document.createRange();return n.setStart(t[0].startContainer,t[0].startOffset),n.setEnd(e.endContainer,e.endOffset),n}(r))}},o.defaults={multipleNodes:!1,onSelection:null},i.prototype.setContent=function(t){document.getElementById(t)},i.prototype.getResponse=function(){},i.prototype.getManager=function(){return this.manager},i.prototype.getElement=function(){var t=this.range.commonAncestorContainer;return t instanceof Element?t:t.parentElement},i.prototype.getBoundingRect=function(){return this.range.getBoundingClientRect()},s.prototype.attach=function(e){var n=this;t(e).each((function(t,e){n.settings.textSelection&&"none"!==n.settings.textSelection&&n.selections.push(new o(e,{multipleNodes:"multi"===n.settings.textSelection,onSelection:function(t,e,o){return n._handleSelection(t,e,o)}}))}))},s.prototype.applyAnnos=function(t){t.test=""},s.prototype.detach=function(){null!=this.tp&&this.tp.destroy(),t.each(this.selections,(function(t,e){e.detach()}))},s.prototype._handleSelection=function(n,o,s){var r=new i({manager:this,content:n,range:s,event:o}),a=r.getElement();0===t(a).parents().addBack().filter("[class=tippy-box]").length&&!1!==this._call("afterSelection",r)&&(null!=this.tp&&this.tp.destroy(),this.tp=new e(a,{content:n,appendTo:document.body,getReferenceClientRect:function(){return r.getBoundingRect()}}))},s.prototype._call=function(t){"string"==typeof t&&(t=this.settings[t]);for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return"function"==typeof t?t.apply(this,n):void 0},s.defaults={subject:null,textSelection:!0,elementSelection:!0,tippySettings:{placement:"auto",hideOnClick:!0,trigger:"manual",allowHTML:!0,interactive:!0,showOnCreate:!0},afterSelection:null,beforeAnno:null,afterAnno:null},s}($,tippy);
//# sourceMappingURL=anno-tip.min.js.map
