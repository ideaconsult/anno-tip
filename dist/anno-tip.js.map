{"version":3,"file":"anno-tip.js.map","sources":["../src/TextMonitor.js","../src/AnnoTip.js"],"sourcesContent":["\"use strict\";\n\nimport $ from 'jquery';\n\nconst NS_SEL = \"annotip-text\";\n\nfunction isMultiElement(range1, range2) {\n\treturn $.unique([\n\t\trange1.startContainer, range1.endContainer, \n\t\trange2.startContainer, range2.endContainer\n\t]).length > 0;\n}\n\nfunction normalizeRange(range) {\n\tconst startNode = range.startContainer,\n\t\tendNode = range.endContainer;\n\n\tif (startNode == endNode) {\n\t\tif (range.startOffset > range.endOffset) {\n\t\t\tconst _t = range.startOffset;\n\n\t\t\trange.setStartOffset(range.endOffset);\n\t\t\trange.setEndOffset(_t);\n\t\t}\n\t}\n\n\treturn range;\n}\n\nfunction mergeRanges(ranges) {\n\tif (ranges.length == 0)\n\t\treturn null;\n\tif (ranges.length == 1)\n\t\treturn ranges[0];\n\t\n\t// TODO: Make sure the ranges are properly ordered.\n\tconst lastR = ranges[ranges.length - 1],\n\t\tunitedR = document.createRange();\n\n\tunitedR.setStart(ranges[0].startContainer, ranges[0].startOffset);\n\tunitedR.setEnd(lastR.endContainer, lastR.endOffset);\n\n\treturn unitedR;\n}\n\n\n/**\n * A wrapper of relevant selection data, to be passed to @see {AnnoTip}.\n * @param {String} content The plain text version of the selected content\n * @param {Event} event The event that triggered the selection (mouseup)\n * @param {Array<Range>} ranges The array of ranges, that this selection occupies\n */\nfunction TextSelection(content, event, ranges) {\n\tthis.content = content;\n\tthis.event = event;\n\tthis.range = mergeRanges(ranges);\n\n}\n\nTextSelection.prototype.getElement = function() {\n\tconst parentEl = this.range.commonAncestorContainer;\n\n\treturn parentEl instanceof Element ? parentEl : parentEl.parentElement;\n};\n\nTextSelection.prototype.getBoundingRect = function () {\n\treturn this.range.getBoundingClientRect();\n};\n\n\n/**\n * Initializes a text selection monitoring mechanis.about-content\n * \n * @param {Element} element The parent DOM element to attach the whole text selection monitoring mechanism to.\n * @param {Object} settings Settings for monitoring. Check @see TextSelection.defaults.\n */ \nfunction TextMonitor(element, settings) {\n\tthis.element = element;\n\tthis.settings = $.extend(true, {}, TextMonitor.defaults, settings);\n\n\tif (this.element.ownerDocument) {\n\t\tthis.document = this.element.ownerDocument;\n\t\t\n\t\t$(this.document.body).on('mouseup.' + NS_SEL, (e) => this._handleSelection(e));\n\t} else {\n\t\tthrow new Error(`Non-attached element used for text selection: ${element}`);\n\t}\n}\n\n/**\n * Detach the text selection monitoring mechanism.\n */\nTextMonitor.prototype.detach = function () {\n\tif (this.document)\n\t\t$(this.document.body).off('.' + NS_SEL);\n};\n\n/**\n * Handles the mouse-up event, supposedly after a selection is made.\n * @param event The actual mouse-up event.\n */\nTextMonitor.prototype._handleSelection = function (event) {\n\tconst selection = this.document.getSelection(); // TODO: Check with defaultView\n\n\tif (selection.isCollapsed)\n\t\treturn;\n\t\n\tconst myRanges = [];\n\n\tfor (let i = 0; i < selection.rangeCount; ++i) {\n\t\tconst r = selection.getRangeAt(i);\n\n\t\tif (!$.contains(this.element, r.commonAncestorContainer))\n\t\t\tcontinue;\n\t\telse if (this.multipleNodes || myRanges.length == 0 || !isMultiElement(myRanges[0], r))\n\t\t\tmyRanges.push(normalizeRange(r));\n\t}\n\n\tif (myRanges.length > 0)\n\t\tthis.settings.onSelection(new TextSelection(selection.toString(), event, myRanges));\n};\n\n/**\n * Default options.\n */\nTextMonitor.defaults = {\n\t// Whether selections over more than one element are allowed.\n\tmultipleNodes: false,\n\t// function (content, event, ranges)\n\tonSelection: null\n};\n\nexport default TextMonitor;\n","\"use strict\";\n\nimport $ from 'jquery';\nimport tippy from 'tippy.js';\nimport TextMonitor  from './TextMonitor';\n\nconst NS_ANNO = 'annotip-main';\nconst FRAME_HTML = `\n<div class=\"annotip-frame\">\n\t<div class=\"annotip-dlg\" style=\"display: none\">{{content}}</div>\n\t<div class=\"annotip-actions\">{{actions}}</div>\n</div>`;\n\nconst DEF_ACTIONS = `\n\t<button data-annotip-action=\"cancel\">Cancel</button>\n\t<button data-annotip-action=\"ok\">OK</button>\n`;\n\nfunction fillTemplate(html, obj) {\n\tfor (const prop in obj) {\n\t\tif (!obj.hasOwnProperty(prop))\n\t\t\tcontinue;\n\t\thtml = html.replace(`{{${prop}}}`, obj[prop]);\n\t}\n\n\treturn html;\n}\n\n/**\n * Initialize the annotation engine\n * @param {Object} settings Custom settings for the annotation engine.\n */\nfunction AnnoTip(settings) {\n\tthis.settings = $.extend(true, {}, AnnoTip.defaults, settings);\n\t\n\t// Normalize the settings\n\tif (typeof this.settings.textSelection === 'string')\n\t\tthis.settings.textSelection = this.settings.textSelection.toLowerCase();\n\n\ttippy.setDefaultProps(this.settings.tippySettings);\n\t\n\tthis.selections = [];\n\tthis.tp = null;\n}\n\n/**\n * Attach handlers - both element\n */\nAnnoTip.prototype.attach = function (selector) {\n\t$(selector).each((i, el) => {\n\t\tif (!el.ownerDocument)\n\t\t\tthrow new Error(`Non-attached element used for anno-tip: ${el}`);\n\n\t\tif (this.settings.textSelection && this.settings.textSelection !== 'none') {\n\t\t\tthis.selections.push(new TextMonitor(el, {\n\t\t\t\tmultipleNodes: this.settings.textSelection === 'multi',\n\t\t\t\tonSelection: (content, event, range) => this._handleSelection(content, event, range)\n\t\t\t}));\n\t\t}\n\t});\n};\n\n/**\n * \n */\nAnnoTip.prototype.applyAnnos = function (annos) {\n\tannos.test = \"\";\n};\n\nAnnoTip.prototype.discard = function () {\n\tthis.tp.destroy();\n\tthis.tp = null;\n};\n\n/**\n * Detach the AnnoTip from the page.\n */\nAnnoTip.prototype.detach = function () {\n\t// Destroy the Tippy instance, if such exists.\n\tif (this.tp != null)\n\t\tthis.tp.destroy();\n};\n\nAnnoTip.prototype._getTippyBox = function () {\n\treturn $(\"[class=tippy-box]\");\n};\n\nAnnoTip.prototype._handleSelection = function (selection) {\n\tconst anno = {\n\t\tselection: selection.content,\n\t\trange: selection.range,\n\t\tevent: selection.event\n\t};\n\n\tif (this.tp != null || this._call('onSelection', anno) === false)\n\t\treturn;\n\t\n\t// Cleanup the previous instance, if such was created.\n\tif (this.tp != null)\n\t\tthis.tp.destroy();\n\n\t// Go, and create a new one.\n\tthis.tp = new tippy(selection.getElement(), {\n\t\tcontent: fillTemplate(FRAME_HTML, { \n\t\t\tactions: anno.actionsHtml || this.settings.actionsHtml, \n\t\t\tcontent: anno.content || anno.selection  // TODO: Fix this!\n\t\t}),\n\t\tappendTo: document.body,\n\t\tonShown: () => {\n\t\t\tconst tpBox$ = this._getTippyBox();\n\t\t\t\n\t\t\tanno.element = tpBox$[0];\n\t\t\ttpBox$.on('click.' + NS_ANNO, 'div.annotip-actions button', (e) => {\n\t\t\t\tthis._call('onAction', $(e.currentTarget).data('annotipAction'), anno, e);\n\t\t\t});\n\t\t},\n\t\tonClickOutside: (tp) => tp.destroy(),\n\t\tonHide: () => this._call('onClose', anno) !== false,\n\t\tonDestroy: () => { this.tp = null; },\n\t\tgetReferenceClientRect: () => selection.getBoundingRect()\n\t});\n};\n\nAnnoTip.prototype._call = function (hnd, ...moreArgs) {\n\tif (typeof hnd === 'string')\n\t\thnd = this.settings[hnd];\n\n\treturn typeof hnd === 'function' ? hnd.apply(this, moreArgs) : undefined;\n};\n\nAnnoTip.defaults = {\n\tsubject: null,\n\ttextSelection: true,\n\telementSelection: true,\n\tactionsHtml: DEF_ACTIONS,\n\ttippySettings: {\n\t\tplacement: 'auto',\n\t\thideOnClick: false,\n\t\ttrigger: 'manual',\n\t\tallowHTML: true,\n\t\tinteractive: true,\n\t\tshowOnCreate: true\n\t},\n\t// Handlers. All accept @see {Anno} as an argument.\n\tonSelection: null,\n\tonAction: null,\n\tonClose: null\n};\n\nexport default AnnoTip;\n"],"names":["NS_SEL","isMultiElement","range1","range2","$","unique","startContainer","endContainer","length","normalizeRange","range","startNode","endNode","startOffset","endOffset","_t","setStartOffset","setEndOffset","mergeRanges","ranges","lastR","unitedR","document","createRange","setStart","setEnd","TextSelection","content","event","prototype","getElement","parentEl","commonAncestorContainer","Element","parentElement","getBoundingRect","getBoundingClientRect","TextMonitor","element","settings","extend","defaults","ownerDocument","body","on","e","_handleSelection","Error","detach","off","selection","getSelection","isCollapsed","myRanges","i","rangeCount","r","getRangeAt","contains","multipleNodes","push","onSelection","toString","NS_ANNO","FRAME_HTML","DEF_ACTIONS","fillTemplate","html","obj","prop","hasOwnProperty","replace","AnnoTip","textSelection","toLowerCase","tippy","setDefaultProps","tippySettings","selections","tp","attach","selector","each","el","applyAnnos","annos","test","discard","destroy","_getTippyBox","anno","_call","actions","actionsHtml","appendTo","onShown","tpBox$","currentTarget","data","onClickOutside","onHide","onDestroy","getReferenceClientRect","hnd","moreArgs","apply","undefined","subject","elementSelection","placement","hideOnClick","trigger","allowHTML","interactive","showOnCreate","onAction","onClose"],"mappings":"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"}